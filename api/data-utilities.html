<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Microcosm</title>

    <meta property="og:title" content="Microcosm" />
    <meta property="og:description" content="Flux with actions at center stage. Write optimistic updates, cancel requests, and track changes with ease."
    <meta property="og:type" content="website" />
    <meta property="og:url" content="http://code.viget.com/microcosm" />
    <meta property="og:image" content="http://code.viget.com/microcosm/assets/microcosm-badge.png" />

    <link rel="stylesheet" href="http://code.viget.com/microcosm/assets/style.css" />
  </head>
  <body>
    <header class="header fill-bloom">
      <div class="header__inner">
        <a href="http://code.viget.com/microcosm">
          <img src="http://code.viget.com/microcosm/assets/microcosm-white.svg" alt="Microcosm" height="24" width="207" />
        </a>

        <nav class="nav">
          <a href="http://code.viget.com/microcosm/guides/quickstart.html">Guides</a>
          <a href="https://github.com/vigetlabs/microcosm">Github</a>
        </nav>
      </div>
    </header>

    <main class="main -with-sidebar">
      <aside class="sidebar">
        <section class="sidebar__group">
          <h4 class="sidebar__heading">Introduction</h4>
          <ul>
            <li><a href="http://code.viget.com/microcosm/guides/quickstart.html">Quickstart</a></li>
            <li><a href="http://code.viget.com/microcosm/guides/architecture.html">Architecture</a></li>
          </ul>
        </section>
        <section class="sidebar__group">
          <h4 class="sidebar__heading">API</h4>
          <ul>
            <li><a href="http://code.viget.com/microcosm/api/microcosm.html">Microcosm</a></li>
            <li><a href="http://code.viget.com/microcosm/api/domains.html">Domains</a></li>
            <li><a href="http://code.viget.com/microcosm/api/actions.html">Actions</a></li>
            <li><a href="http://code.viget.com/microcosm/api/effects.html">Effects</a></li>
            <li><a href="http://code.viget.com/microcosm/api/data-utilities.html">Data Utilities</a></li>
          </ul>
        </section>
        <section class="sidebar__group">
          <h4 class="sidebar__heading">Addons</h4>
          <ul>
            <li><a href="http://code.viget.com/microcosm/api/presenter.html">Presenter</a></li>
            <li><a href="http://code.viget.com/microcosm/api/form.html">Form</a></li>
            <li><a href="http://code.viget.com/microcosm/api/intent-button.html">IntentButton</a></li>
            <li><a href="http://code.viget.com/microcosm/api/with-intent.html">withIntent</a></li>
          </ul>
        </section>
        <section class="sidebar__group">
          <h4 class="sidebar__heading">Testing</h4>
          <ul>
            <li><a href="http://code.viget.com/microcosm/testing/overview.html">Overview</a></li>
            <li><a href="http://code.viget.com/microcosm/testing/domains.html">Domains</a></li>
            <li><a href="http://code.viget.com/microcosm/testing/effects.html">Effects</a></li>
            <li><a href="http://code.viget.com/microcosm/testing/intents.html">Intents</a></li>
          </ul>
        </section>
        <section class="sidebar__group">
          <h4 class="sidebar__heading">Recipes</h4>
          <ul>
            <li><a href="http://code.viget.com/microcosm/recipes/ajax.html">AJAX</a></li>
            <li><a href="http://code.viget.com/microcosm/recipes/react-router.html">React Router</a></li>
            <li><a href="http://code.viget.com/microcosm/recipes/immutable-js.html">ImmutableJS</a></li>
            <li><a href="http://code.viget.com/microcosm/recipes/hydrating-state.html">Hydrating State</a></li>
            <li><a href="http://code.viget.com/microcosm/recipes/preact.html">Preact</a></li>
          </ul>
        </section>
      </aside>

      <div class="content"><h1 id="data-utilities">Data Utilities</h1>
<p><strong>Microcosm requires non-destructive management of data.</strong> There are many benefits to this approach, however it can sometimes feel cumbersome. Microcosm ships with a few utilities that help to alleviate this.</p>
<h2 id="getobject-keypath-fallback">get(object, keypath, fallback?)</h2>
<p>Safely retrieve a value from an object. If that value is not defined, optionally return a fallback value:</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="im">import</span> <span class="op">{</span> get <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;microcosm&#39;</span>

<span class="kw">let</span> state <span class="op">=</span> <span class="op">{</span>
  <span class="dt">planets</span><span class="op">:</span> <span class="op">{</span>
    <span class="dt">earth</span><span class="op">:</span> <span class="op">{</span> <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;blue&#39;</span> <span class="op">},</span>
    <span class="dt">mars</span><span class="op">:</span> <span class="op">{</span> <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;red&#39;</span> <span class="op">}</span>
  <span class="op">}</span>
<span class="op">}</span>

<span class="co">// Pass a simple string key</span>
<span class="kw">let</span> planets <span class="op">=</span> <span class="at">get</span>(state<span class="op">,</span> <span class="st">&#39;planets&#39;</span>)
<span class="va">console</span>.<span class="at">log</span>(planets) <span class="co">// { earth, mars }</span>

<span class="co">// Or an array of keys to access a deeply nested value</span>
<span class="kw">let</span> earth <span class="op">=</span> <span class="at">get</span>(state<span class="op">,</span> [<span class="st">&#39;planets&#39;</span><span class="op">,</span> <span class="st">&#39;earth&#39;</span>])
<span class="va">console</span>.<span class="at">log</span>(earth) <span class="co">// { color: &#39;blue&#39; }</span>

<span class="co">// Optionally, provide a fallback if a value isn&#39;t found</span>
<span class="kw">let</span> color <span class="op">=</span> <span class="at">get</span>(state<span class="op">,</span> [<span class="st">&#39;planets&#39;</span><span class="op">,</span> <span class="st">&#39;venus&#39;</span><span class="op">,</span> <span class="st">&#39;color&#39;</span>]<span class="op">,</span> <span class="st">&#39;black&#39;</span>)
<span class="va">console</span>.<span class="at">log</span>(color) <span class="co">// &#39;black&#39;</span></code></pre></div>
<h2 id="setobject-keypath-value">set(object, keypath, value)</h2>
<p>Safely assign a property to an object. If the keypath provided is not defined within the object, it will produce new objects until it reaches the final key, in which case it will assign the value.</p>
<p><code>set</code> never modifies data in place. It will always return a new object, unless assigning the value would make no change.</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="im">import</span> <span class="op">{</span> set <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;microcosm&#39;</span>

<span class="kw">let</span> state <span class="op">=</span> <span class="op">{</span>
  <span class="dt">planets</span><span class="op">:</span> <span class="op">{</span>
    <span class="dt">earth</span><span class="op">:</span> <span class="op">{</span> <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;blue&#39;</span> <span class="op">},</span>
    <span class="dt">mars</span><span class="op">:</span> <span class="op">{</span> <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;red&#39;</span> <span class="op">}</span>
  <span class="op">}</span>
<span class="op">}</span>

<span class="co">// Pass a simple string key</span>
<span class="kw">let</span> next <span class="op">=</span> <span class="at">set</span>(state<span class="op">,</span> <span class="st">&#39;center&#39;</span><span class="op">,</span> <span class="st">&#39;sol&#39;</span>)
<span class="va">console</span>.<span class="at">log</span>(next) <span class="co">// { center, planets }</span>

<span class="co">// Or an array of keys to deeply assign a value</span>
<span class="kw">let</span> next <span class="op">=</span> <span class="at">set</span>(state<span class="op">,</span> [<span class="st">&#39;planets&#39;</span><span class="op">,</span> <span class="st">&#39;venus&#39;</span>]<span class="op">,</span> <span class="op">{</span> <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;yellow&#39;</span> <span class="op">}</span>)
<span class="va">console</span>.<span class="at">log</span>(state) <span class="co">// { planets: { venus, earth, mars } }</span>

<span class="co">// If the value is the same, no change will occur</span>
<span class="kw">let</span> next <span class="op">=</span> <span class="at">set</span>(state<span class="op">,</span> [<span class="st">&#39;planets&#39;</span><span class="op">,</span> <span class="st">&#39;earth&#39;</span><span class="op">,</span> <span class="st">&#39;color&#39;</span>]<span class="op">,</span> blue)
<span class="va">console</span>.<span class="at">log</span>(next <span class="op">===</span> subject) <span class="co">// true</span></code></pre></div>
<h2 id="mergeobjects">merge(…objects)</h2>
<p>Non-destructively merge together the keys of any number of objects, starting from left to right. Returns a new object if any of the keys changed.</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="im">import</span> <span class="op">{</span> merge <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;microcosm&#39;</span>

<span class="kw">let</span> earth <span class="op">=</span> <span class="op">{</span> <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;blue&#39;</span> <span class="op">}</span>

<span class="co">// Folding in new values returns an new object</span>
<span class="kw">let</span> newEarth <span class="op">=</span> <span class="at">merge</span>(earth<span class="op">,</span> <span class="op">{</span> <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;azule&#39;</span> <span class="op">}</span>)
<span class="va">console</span>.<span class="at">log</span>(newEarth) <span class="co">// { color: &#39;azule&#39; }</span>
<span class="va">console</span>.<span class="at">log</span>(newEarth <span class="op">===</span> earth) <span class="co">// false</span>

<span class="co">// Folding in the same values yields no change</span>
<span class="kw">let</span> update <span class="op">=</span> <span class="at">merge</span>(earth<span class="op">,</span> <span class="op">{</span> <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;blue&#39;</span> <span class="op">}</span>
<span class="va">console</span>.<span class="at">log</span>(updated <span class="op">===</span> earth) <span class="co">// true</span></code></pre></div></div>
    </main>

    <footer class="footer">
      <div class="footer__inner">
        <nav class="footer__left">
          <a href="https://www.npmjs.com/package/microcosm">
            <img src="https://img.shields.io/npm/v/microcosm.svg?style=flat-square" alt="View package on NPM" />
          </a>
          <a href="http://code.viget.com/microcosm/changelog.html">Changelog</a>
          <a href="https://github.com/vigetlabs/microcosm">Source</a>
        </nav>
        <div class="footer__right">
          Built with patience and time by <a href="https://viget.com">●° Viget</a>
        </div>
      </div>
    </footer>

    <script>
      // set active links
      (function() {
        var location = window.location.toString()

        for (var i = 0; i < document.links.length; i++) {
          if (document.links[i].href === location) {
            document.links[i].classList.add('active')
          }
        }
      }())
    </script>
  </body>
</html>
